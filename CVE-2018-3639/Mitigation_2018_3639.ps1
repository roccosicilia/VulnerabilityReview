# Key Path
$keyPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"

# FeatureSettingsOverride
$valueName1 = "FeatureSettingsOverride"
$valueData1 = 8
$valueType1 = "DWORD"
# FeatureSettingsOverrideMask
$valueName2 = "FeatureSettingsOverrideMask"
$valueData2 = 3
$valueType2 = "DWORD"

# check for FeatureSettingsOverride, add if not present
if (-not (Get-ItemProperty -Path $keyPath -Name $valueName1 -ErrorAction SilentlyContinue)) {
    New-ItemProperty -Path $keyPath -Name $valueName1 -Value $valueData1 -PropertyType $valueType1 -Force
    Write-Output "Item $valueName1 created."
} else {
    Write-Output "The Item is already present."
}

# check for FeatureSettingsOverrideMask, add if not present
if (-not (Get-ItemProperty -Path $keyPath -Name $valueName2 -ErrorAction SilentlyContinue)) {
    New-ItemProperty -Path $keyPath -Name $valueName2 -Value $valueData2 -PropertyType $valueType2 -Force
    Write-Output "Item $valueName2 created."
} else {
    Write-Output "The Item is already present."
}
